Meteor.startup(function() {
	// read environment variables from Meteor.settings
	if(Meteor.settings && Meteor.settings.env && _.isObject(Meteor.settings.env)) {
		for(var variableName in Meteor.settings.env) {
			process.env[variableName] = Meteor.settings.env[variableName];
		}
	}


	
if(!CommonCommandSet.find().count()) {
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Abort','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'DoContinue','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GetDeviceIdentification','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GetStatus','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Initialize','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'LockDevice','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Pause','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Reset','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'UnlockDevice','parameters':'','returnValues':'','0':'M','1':'M','2':'M','3':'M','4':'M','5':'M','6':'M','7':'M','8':'M','9':'M','10':'M','11':'M','12':'M','13':'M','14':'M','15':'M','16':'M','17':'M','18':'M','19':'M','20':'M','21':'M','22':'M','23':'M','24':'M','25':'M','26':'M','27':'M','28':'M','29':'M','30':'M','31':'M','901':'M','902':'M','903':'M','1000':'M'});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ActivateStopper','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'AddLid','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Aspirate','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'AttachStack ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'CalculateComplexPosition','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'CalculatePositionID','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Cap ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'CloseDoor ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'CloseGripper','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Decap','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Delay','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Dispense ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'DispenseByColumn','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'DownStack ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'EjectTip ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'EmptyTubes ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Evaporate','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ExecuteMethod ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GetConfiguration ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GetInventory','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GetLabware','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GetParameters','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GetTemperature','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GetTip ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'GoToValvePosition','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'LabwareDelivered','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'LabwareRemoved','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Home ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'MeasureSample ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'MoveAbsolute ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'MoveEndless','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'MoveLabware','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'MoveToPosition ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'OpenDoor','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'OpenGripper ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Peel','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Pierce','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'PrepareForInput ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'PrepareForOutput ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Prime','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Pump','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'PutLabware ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReadAllAnalogInputs','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReadAllDigitalInputs ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReadAnalogInput','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReadCode','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReadMultipleCodes ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReadDigitalInput','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReadPlate ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReadWell','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'RegisterStatusEventURL','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ReleaseStack ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'RemoveLid ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ResetDigitalOutput ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'RetrieveByPositionId ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'RetrieveByLabwareIdentifier','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Rinse','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'ScanInventory','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Seal','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetAnalogOutput','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetConfiguration','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetDigitalOutput ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetNamedAnalogOutput','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetNamedDigitalOutput','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetLanguage','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetParameters ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetTag ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'SetTemperature','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Shake','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Spin','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'StartTempControl','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'StopMethod','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'StopMotion ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'StopTemperatureControl','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'StoreAtPosition','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'StoreImage','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'StoreImageSeries','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Tare','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'TeachPosition ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'TransferLiquid ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'TransferTube','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'UnRegisterStatusEventReceiver','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'UpStack','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Wash','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'Weigh','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'WriteCode ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
	CommonCommandSet.insert({'deviceClassVersion':'0.97','name':'WriteCodeSeries ','parameters':'','returnValues':'','0':'','1':'','2':'','3':'','4':'','5':'','6':'','7':'','8':'','9':'','10':'','11':'','12':'','13':'','14':'','15':'','16':'','17':'','18':'','19':'','20':'','21':'','22':'','23':'','24':'','25':'','26':'','27':'','28':'','29':'','30':'','31':'','901':'','902':'','903':'','1000':''});
}

});

Meteor.methods({
	  "connectDeviceSoap": function(url, operation, args) {

		var soap = Meteor.npmRequire('soap');	  	
	  	
		//declare an async function
		function delayedSoapRequest(callback) {
  			setTimeout(function() {
			soap.createClient(url, function(err, client) {
				if(!err){
					if(operation == "GetDeviceIdentification"){
			      			client.GetDeviceIdentification(args, function(err, soapResult) {
							callback(null, soapResult);		
			     			});
					}
					else{callback(err);}
				}else{callback(err);}
			});
  			}, 2300);//delay for simulation - see the "Connecting..." message
		}

		//wrapping async for Meteor (works sync only)
		var wrappedDelayedSoapRequest = Async.wrap(delayedSoapRequest);

    		var response = wrappedDelayedSoapRequest();
    		return response;
  	},

	"createUserAccount": function(options) {
		if(!Users.isAdmin(Meteor.userId())) {
			throw new Meteor.Error(403, "Access denied.");
		}

		var userOptions = {};		
		if(options.username) userOptions.username = options.username;
		if(options.email) userOptions.email = options.email;
		if(options.password) userOptions.password = options.password;
		if(options.profile) userOptions.profile = options.profile;
		if(options.profile && options.profile.email) userOptions.email = options.profile.email;

		Accounts.createUser(userOptions);
	},
	"updateUserAccount": function(userId, options) {
		// only admin or users own profile
		if(!(Users.isAdmin(Meteor.userId()) || userId == Meteor.userId())) {
			throw new Meteor.Error(403, "Access denied.");
		}

		// non-admin user can change only profile
		if(!Users.isAdmin(Meteor.userId())) {
			var keys = Object.keys(options);
			if(keys.length !== 1 || !options.profile) {
				throw new Meteor.Error(403, "Access denied.");
			}
		}

		var userOptions = {};		
		if(options.username) userOptions.username = options.username;
		if(options.email) userOptions.email = options.email;
		if(options.password) userOptions.password = options.password;
		if(options.profile) userOptions.profile = options.profile;

		if(options.profile && options.profile.email) userOptions.email = options.profile.email;
		if(options.roles) userOptions.roles = options.roles;

		if(userOptions.email) {
			var email = userOptions.email;
			delete userOptions.email;
			userOptions.emails = [{ address: email }];
		}

		var password = "";
		if(userOptions.password) {
			password = userOptions.password;
			delete userOptions.password;
		}

		if(userOptions) {
			Users.update(userId, { $set: userOptions });
		}

		if(password) {
			Accounts.setPassword(userId, password);
		}
	},

	"sendMail": function(options) {
		this.unblock();

		Email.send(options);
	}


});

Accounts.onCreateUser(function (options, user) {
	user.roles = [];

	if(options.profile) {
		user.profile = options.profile;
	}

	
Devices.insert({silaDeviceClassId:'1', silaDeviceClassVersion:'0.97', name: 'Demo Thermo Combi Multidrop', status: 'idle', url: 'http://192.0.0.23:8080/dispenser', ownerId: user._id });

	return user;
});

Accounts.validateLoginAttempt(function(info) {

	// reject users with role "blocked"
	if(info.user && Users.isInRole(info.user._id, "blocked")) {
		throw new Meteor.Error(403, "Your account is blocked.");
	}

	return true;
});


Users.before.insert(function(userId, doc) {
	if(doc.emails && doc.emails[0] && doc.emails[0].address) {
		doc.profile = doc.profile || {};
		doc.profile.email = doc.emails[0].address;
	}
});

Users.before.update(function(userId, doc, fieldNames, modifier, options) {
	if(modifier.$set && modifier.$set.emails && modifier.$set.emails.length && modifier.$set.emails[0].address) {
		modifier.$set.profile.email = modifier.$set.emails[0].address;
	}
});

Accounts.onLogin(function (info) {
	
});

Accounts.urls.resetPassword = function (token) {
	return Meteor.absoluteUrl('reset_password/' + token);
};
